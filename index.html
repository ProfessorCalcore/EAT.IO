<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <title>EAT.IO</title>
<style>

body{
background: black;
margin: 0;
overflow: hidden;
}

#buttons-container{
    position: absolute;
    top: 70%;
    left: 46%;
    width: 200px;
    height: 100px;
    display: inline;
}

#up{
    position: relative;
    background: transparent;
    outline: none;
    border: 0;
    font-size: 300%;
    user-select: none;
}

#left{
    position: relative;
    background: transparent;
    outline: none;
    border: 0;
    font-size: 300%;
    top: 30%;
    left: -85%;    user-select: none;
}

#right{
    position: relative;
    background: transparent;
    outline: none;
    border: 0;
    font-size: 300%;
    top: -30%;
    left: 0%;
    user-select: none;
}

#down{
    position: relative;
    outline: none;
    border: 0;
    background: transparent;
    font-size: 300%;
    user-select: none;

}

#balls-swallowed-label{
    position: absolute;
    background-color: black;
    color: white;
    font-size: 20px;
}

#metallic-balls-swallowed-label{
    position: absolute;
    background-color: black;
    color: white;
    font-size: 20px;
    top: 5%;
}

#size-label{
    position: absolute;
    background-color: black;
    color: white;
    font-size: 20px;
    top: 10%;
}

#speed-label{
    position: absolute;
    background-color: black;
    color: white;
    font-size: 20px;
    top: 15%;
}


#upgrade-speed-button{
    position: absolute;
    background-color: black;
    color: white;
    top: 20%;
    font-size: 20px;
}

</style>

    </head>

    <body>
<div id="buttons-container">
    <button id="up">‚¨ÜÔ∏è</button>
    <button id="left">‚¨ÖÔ∏è</button>
    <button id="down">‚¨áÔ∏è</button>
    <button id="right">‚û°Ô∏è</button>
</div>

<label id="balls-swallowed-label">Balls Swallowed: 0</label>
<label id="metallic-balls-swallowed-label">Metallic Balls Swallowed: 0</label>



<label id="size-label">Size: 0.12</label>
<label id="speed-label">Speed: 0.05</label>


<button id="upgrade-speed-button">Upgrade Speed: 1 Metallic Orb</button>
<audio id="eat-sfx" src="https://raw.githubusercontent.com/ProfessorCalcore/EAT.IO/main/pop-423717.mp3" preload="auto"></audio>



<script type="module">
// ========================
// ‚öôÔ∏èTHREE.JS‚öôÔ∏è
// ======================== 
import * as THREE from "https://unpkg.com/three@0.170.0/build/three.module.js";


// ========================
// ‚öôÔ∏èGUI SET UP‚öôÔ∏è
// ========================
const buttonsContainer = document.querySelector("#buttons-container");
const up = document.querySelector("#up");
const down = document.querySelector("#down");
const left = document.querySelector("#left");
const right = document.querySelector("#right");

const ballsSwallowedLabel = document.querySelector("#balls-swallowed-label");
const sizeLabel = document.querySelector("#size-label");
const speedLabel = document.querySelector("#speed-label");
const metallicBallsSwallowedLabel = document.querySelector("#metallic-balls-swallowed-label");
const upgradeSpeedButton = document.querySelector("#upgrade-speed-button");

const eatSfx = document.querySelector("#eat-sfx");

// ========================
// ‚öôÔ∏èVARIABLES‚öôÔ∏è
// ========================
let angle = 0;
let speed = 0.05;
let camAngle = 0;
let camRadius = 5;
let currentFood = null;
const keys = {};
let ballsSwallowed = 0;
let originalRadius = 0.12;
const foodSize = new THREE.Vector3();
const playerSize = new THREE.Vector3();
let metallicBalls = 0;
let speedCost = 1;
let sunDied = false;
let colors = [
  "red","green","blue","yellow","orange","purple","pink","cyan",
  "lime","magenta","brown","teal","navy","maroon","olive","silver",
  "gray","black","white","gold","coral","turquoise","violet","indigo",
  "salmon","khaki","plum","orchid","peru","tan","lavender","crimson",
  "aqua","beige","chocolate","firebrick","forestgreen","fuchsia","hotpink",
  "skyblue","mintcream","powderblue","seagreen","tomato","sienna",
  "slateblue","steelblue","mediumvioletred","mediumslateblue","mediumorchid",
  "springgreen","mediumseagreen","midnightblue","palegoldenrod","peachpuff",
  "papayawhip","moccasin","ivory","honeydew","gainsboro","darkslategray",
  "darkolivegreen","darkorange","darkorchid","darkred","darksalmon",
  "darkseagreen","darkslateblue","darkturquoise","darkviolet","deeppink",
  "deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen",
  "fuchsia","gainsboro","ghostwhite","goldenrod","gray","greenyellow","honeydew",
  "hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush",
  "lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow",
  "lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue",
  "lightslategray","lightsteelblue","lightyellow","limegreen","linen","magenta",
  "mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen",
  "mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred",
  "midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace",
  "olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise",
  "palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue",
  "rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen",
  "seashell","sienna","skyblue","slateblue","slategray","snow","springgreen",
  "steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke",
  "yellowgreen","rebeccapurple","aliceblue","antiquewhite","aquamarine","azure"
];



// ========================
// ‚¨ÜÔ∏èDISPLAYS MOBILE BUTTONS‚¨ÜÔ∏è
// ========================
let mobileCheck = prompt
(`Are you playing on mobile/tablet? This will enable mobile controls.
Type Y to activate Mobile Controls
Type N to use default Laptop Controls`);
if(mobileCheck === "N") buttonsContainer.style.display = "none";

// ========================
// UPGRADE SPEED
// ========================
upgradeSpeedButton.addEventListener("click", function() {
    if(metallicBalls >= speedCost) {
        metallicBalls -= speedCost;
        metallicBallsSwallowedLabel.textContent = "Metallic Balls Swallowed: " + metallicBalls;
        speedCost *= 5;
        upgradeSpeedButton.textContent = "Upgrade Speed: " + speedCost + " Metallic Orbs";
        speed += 0.01;
        speedLabel.textContent = "Speed: " + speed;

    }
});


// ========================
// üéÆMOBILE/LAPTOP MOVEMENT TRIGGERSüéÆ
// ========================
document.body.addEventListener("keydown", function(event){
    keys[event.key] = true;
});
document.body.addEventListener("keyup", function(event){
    keys[event.key] = false;
});
up.addEventListener("touchstart", function() {
    keys["w"] = true;
});
down.addEventListener("touchstart", function() {
    keys["w"] = false;;
});
right.addEventListener("touchstart", function() {
    keys["ArrowRight"] = true;
});
right.addEventListener("touchend", function() {
    keys["ArrowRight"] = false;
});
left.addEventListener("touchstart", function() {
    keys["ArrowLeft"] = true;
});
left.addEventListener("touchend", function() {
    keys["ArrowLeft"] = false;
});

// ========================
// üé¨SCENE, CAMERA AND RENDERER SETUPüé¨
// ========================
const scene = new THREE.Scene();
scene.background = new THREE.Color("rgb(135, 206, 235)");
const camera = new THREE.PerspectiveCamera(85, window.innerWidth/ window.innerHeight, 1, 1000);

const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ========================
// ‚òÄÔ∏èSUN SET UP‚òÄÔ∏è
// ========================
const sunGeometry = new THREE.SphereGeometry(5,100,100);
const sunMaterial = new THREE.MeshStandardMaterial({
color: "white",
emissive: "white",
emissiveIntensity: 100,
});
const sun = new THREE.Mesh(sunGeometry, sunMaterial);
sun.position.set(0,10,-1000)
scene.add(sun);

// ========================
// üî¥PLAYER-SPRITE SET UPüî¥
// ========================
const playerGeometry = new THREE.SphereGeometry(0.12,100,100);
const playerMaterial = new THREE.MeshStandardMaterial({
    color: "silver",
    roughness: 0,
    metalness: 1,
   

});
const playerSprite = new THREE.Mesh(playerGeometry, playerMaterial);
playerSprite.position.copy(camera.position);
playerSprite.position. y = 5;
scene.add(playerSprite);

// ========================
// üí°LIGHT SET UPüí°
// ========================
const light = new THREE.PointLight("white", 50000000, 10000);
light.position.copy(sun.position);
light.position.z += 10;
scene.add(light);

// ========================
// üü©FLOOR SET UPüü©
// ========================
let randomfloorcolor = Math.floor(Math.random() * colors.length);
const floorGeometry = new THREE.PlaneGeometry(200,400,200);
const floorMaterial = new THREE.MeshStandardMaterial({
color: "lime",
side: THREE.DoubleSide,
roughness: 0.1,
metalness: 0.9,
});
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = Math.PI/2;
scene.add(floor);


// ========================
// Wall SET UP
// ========================
const wallGeo = new THREE.PlaneGeometry(200,4);
const wallMat = new THREE.MeshBasicMaterial({color: "black"});
const wallGeo2 = new THREE.PlaneGeometry(400,4);

const nwall = new THREE.Mesh(wallGeo, wallMat);
nwall.position.z -= 200;
nwall.position.y += 2;

const swall = new THREE.Mesh(wallGeo, wallMat);
swall.position.z += 200;
swall.position.y += 2;
swall.rotation.y = Math.PI;

const ewall = new THREE.Mesh(wallGeo2, wallMat);
ewall.position.x += 100;
ewall.position.y += 2;
ewall.rotation.y = -Math.PI/2;

const wwall = new THREE.Mesh(wallGeo2, wallMat);
wwall.position.x -= 100;
wwall.position.y += 2;
wwall.rotation.y = Math.PI/2;


scene.add(nwall, ewall, wwall);


const foods = [];
// ========================
// üü°FOOD SET UPüü°
// ========================
for(let i=0; i < 100; i++) {
    const foodGeo = new THREE.SphereGeometry(0.1, 10, 10);

    const foodMat = new THREE.MeshBasicMaterial({color: "white"});
    const food = new THREE.Mesh(foodGeo, foodMat);

    let max = 50;
    let min = -50;

    let randomx = Math.floor(Math.random() * (max-min) + min);
    let randomz = Math.floor(Math.random() * ((max*2)-min) + min);

    food.position.set(randomx, 5, randomz);
    food.orbit = food.position.clone();
    foods.push(food);
    scene.add(food);
}
// ========================
// üì¶BOX BOUNDARYüì¶
// ========================
const ballBox = new THREE.Box3().setFromObject(playerSprite);
foods.forEach(function(food) {
    const foodBox = new THREE.Box3().setFromObject(food);
});
    let max = 100;
    let min = -100;
// ========================
// üß¨RECREATE FOOD FUNCTIONüß¨
// ========================
function recreateFood() {
    ballsSwallowed += 1;
    ballsSwallowedLabel.textContent = "Balls Swallowed: " + ballsSwallowed; 




let randomColor = Math.floor(Math.random() * colors.length);
    ballBox.getSize(playerSize);
    let minr = playerSize.x/5;
    let maxr = playerSize.x * 5;

    let playerRadius = playerSprite.geometry.parameters.radius;
    let randomr = Math.random() * (maxr - minr) + minr;

    const foodGeo = new THREE.SphereGeometry(randomr,100,100);
    const foodMat = new THREE.MeshStandardMaterial({
        color: colors[randomColor],
	roughness: 0,
	metalness: 1,
    });
    const food = new THREE.Mesh(foodGeo, foodMat);

    let randomx = Math.floor(Math.random() * (max - min) + min);
    let randomz = Math.floor(Math.random() * (max - min) + min);

    food.position.set(randomx,5,randomz);
    food.orbit = food.position.clone();
    food.angle = Math.random() * 360;

    const foodBox = new THREE.Box3().setFromObject(food)
    foods.push(food);
    scene.add(food);
}

foods.forEach(function(food) {
    let randomAngle = Math.random() * 360;
    food.angle = randomAngle;
});

// ========================
// üé¨ANIMATION FUNCTIONüé¨
// ========================
function animate() {
    requestAnimationFrame(animate);
    const sunBox = new THREE.Box3().setFromObject(sun);

    ballBox.setFromObject(playerSprite);
foods.forEach(function(food) {
    const foodBox = new THREE.Box3().setFromObject(food);


    if(ballBox.intersectsBox(foodBox)) {
        eatSfx.currentTime = 0;
        eatSfx.play();
        food.angle = Math.random() * 360;

        foodBox.getSize(foodSize);
        ballBox.getSize(playerSize);

        let scale = 1 + (foodSize.x/20);
        if(scale >= 1.25) scale = 1.25;
        playerSprite.scale.multiplyScalar(scale);
        originalRadius = originalRadius * scale;
        originalRadius = originalRadius.toFixed(4);
        sizeLabel.textContent = "Size: " + originalRadius;

 


        if(foodSize.x /2 > playerSize.x /2) {
            alert("You got eaten! Game Over");
            alert("Balls Swallowed: " + ballsSwallowed)
            location.reload();
        }

        if(foodSize.x/2 > 0.11) {
            metallicBalls += 1;
            metallicBallsSwallowedLabel.textContent = "Metallic Balls Swallowed: " + metallicBalls;      
        }


	let max = 50
        let min = -50;
        ballBox.getSize(playerSize);
        camRadius = playerSize.x + 4;

        let randomx = Math.floor(Math.random() * (max-min) + min);
        let randomz = Math.floor(Math.random() * (max - min) + min);

        food.position.set(randomx, 5, randomz);      
        recreateFood();

    }

    if(ballBox.intersectsBox(sunBox)) {
        scene.remove(sun); 
        sunDied = true;
        light.position.copy(playerSprite.position);
        light.intensity = 100;
        scene.background = new THREE.Color("black");
        
    }



    foods.forEach(function(food) {
        if(!food.orbit) return;
        food.angle += 0.000003;
        food.position.x = food.orbit.x + 50 * Math.cos(food.angle);
        food.position.z = food.orbit.z + 50 * Math.sin(food.angle);
    });


});




    let camHeight = 3;

    camera.position.x = playerSprite.position.x + camRadius * Math.sin(camAngle);
    camera.position.z = playerSprite.position.z + camRadius * Math.cos(camAngle);
    camera.position.y = playerSprite.position.y + camHeight;
    camera.lookAt(playerSprite.position);

    angle += 0.00002;
    const orbitRadius = 800;

    sun.position.z = orbitRadius * Math.cos(angle);
    sun.position.y = orbitRadius * Math.sin(angle);
    if(sun.position.y < -5 && !sunDied) scene.background = new THREE.Color("#04081c");
    else if(sun.position.y >= -4 && !sunDied) scene.background = new THREE.Color("skyblue");
    if(!sunDied) light.position.copy(sun.position);
    if(sunDied) light.position.copy(playerSprite.position);

// ========================
// üéÆKEY PRESSESüéÆ
// ========================
if(keys["w"]) {
    playerSprite.position.z -= Math.cos(camAngle) * speed;
    playerSprite.position.x -= Math.sin(camAngle) * speed;
    
}

if(keys["s"]) {
    playerSprite.position.z += Math.cos(camAngle) * speed;
    playerSprite.position.x += Math.sin(camAngle) * speed;

}

if(keys["d"]) {
    playerSprite.position.x += Math.cos(camAngle) * speed;
    playerSprite.position.z -= Math.sin(camAngle) * speed;
}

if(keys["a"]) {
    playerSprite.position.x -= Math.cos(camAngle) * speed;
    playerSprite.position.z += Math.sin(camAngle) * speed;
}

if(keys["ArrowRight"]) {
    camAngle -= 0.01;
}

if(keys["ArrowLeft"]) {
    camAngle += 0.01
}
renderer.render(scene, camera);
}
animate();

// ========================
// END OF SCRIPT
// ========================
</script>
    </body>
</html>










